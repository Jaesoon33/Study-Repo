1. 스레드를 이해하기 위한 배경지식

Layer 4: 스레드 (Thread) 
    - 프로세스 안에서 실행되는 작업의 최소 단위 (경량 프로세스)
    - 같은 프로세스의 스레드들은 Heap 메모리를 공유 --> 데이터 교환 빠름
    - 각 스레드는 자기만의 stack을 가짐 (독립적인 메서드 호출 흐름)
    - Heap 공유 --> 동기화(Synchronized) 필요!
    - 비유
        - 같은 주문서(프로세스)안의 세부 요리 단계
            --> 같은 재료(Heap)를 공유하지만, 각자 조리 순서(stack)는 따로!
-------------------------------------------------------------------------------------------
                                    프로세스 안에서 스레드 생성 
-------------------------------------------------------------------------------------------
Layer 3: 프로세스 (Process)
    - 실행 중인 프로그램의 인스턴스 (프로그램 파일 자체 != 프로세스)
    - OS가 프로세스마다 독립적인 메모리 공간을 할당해줌 
    - 프로세스끼리는 서로의 메모리에 접근 불가 --> 격리(안전) 
    - 비유 : 주문서 
        - 각 주문은 독립적. 1번 주문의 재료를 2번이 가져갈 수 없음 
    - 예시
        - Chrome, IntelliJ, KakaoTalk = 각각 별도 프로세스 
--------------------------------------------------------------------------------------------
                            OS가 프로세스를 생성/관리        
--------------------------------------------------------------------------------------------
Layer 2: 운영체제 (OS - Operating System)
    - 하드웨어(CPU,RAM)를 관리하고, 프로그램이 하드웨어를 사용할 수 있게 해주는 소프트웨어
    - Windows, macOS, Linux
    - 여러 프로그램이 CPU와 메모리를 공평하게 나눠 쓰도록 관리
    - 비유
        - 주방장(헤드 세프) 
            - 요리사(CPU)에게 어떤 주문(프로그램)을 처리할지 지시하고, 
              작업대(RAM)의 공간을 배분하는 관리자 

    - OS 핵심 역할 (면접 키워드)
        - 1) CPU 스케쥴링 
            - 어떤 프로그램이 CPU를 쓸지 결정
                --> 스레드 실행 순서를 OS가 결정!
        - 2) 메모리 관리
            - 프로그램마다 메모리 영역을 할당/보호
                --> 프로세스간 메모리 격리!
        - 3) 프로세스/스레드 관리 
            - 프로그램 실행 단위를 생성/종료/전환
                --> 컨텍스트 스위칭(Context Switching)
                    - CPU가 A작업 --> B작업 전환할 때
                      A의 상태를 저장하고 B의 상태를 복원하는 과정 
                        --> 매우 빨라서 동시에 실행되는 것처럼 보임!                        

--------------------------------------------------------------------------------------------------------

                                            OS가 하드웨어를 관리
--------------------------------------------------------------------------------------------------------
Layer 1: 하드웨어 (Hardware)
    CPU (Central Processing Unit) -- 두뇌(요리사)             RAM (Random Access Memory) -- 작업대
    -------------------------------------------             -------------------------------------------
    - 프로그램의 명령어를 실제로 계산/실행하는 장치                 - 실행 중인 프로그램과 데이터를 임시 저장하는 공간
    - 한 번에 한 가지 일만 처리 기능 (단일 코어 기준)               - CPU가 직접 읽고 쓸 수 있는 빠른 메모리  
    - 비유                                                     - 전원 끄면 내용 사라짐 (휘발성)          
        - 요리사                                데이터 주고받기                
            - 한 번에 하나의 요리만 조리 가능                      - 비유: 요리 작업대  
        - 코어가 여러 개면 => 요리사가 여러 명!                         - 재료를 올려놓고 조리하는 공간 
                                                                    - 작업대가 넓으면 = 여러 재료를 동시에 펼쳐놓을 수 있음     

2. Race Condition 
    1) 경쟁 상태
    2) 정의
        - 두 개 이상의 스레드가 동시에 같은 데이터를 읽고 쓸 때,
          실행 순서(타이밍)에 따라 결과가 달라지는 현상 
    3) 예
        - "ATM 동시 출금"
            - 잔고 : 10,000원

                [ATM-1]                    [ATM-2]    
                1) 잔고 확인 : 10,000원      1) 잔고 확인 : 10,000원
                2) 출금: 10,000-1,000원     2) 출금: 10,000-1,000원
                        = 9,000원                   = 9,000원     <--- 같은 값!

                --> 2,000원이 빠져야 하는데 1,000원만 빠짐!
                ---> 이것이 Race Condition!                            